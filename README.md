System management sytem

To design a System Management System in PL/SQL (using Oracle 21c XE), we first need to define the entities (tables) and their relationships.

1. Conceptual Diagram Design
   Here are the potential tables and relationships we could define:

Users: Stores user information.
Roles: Defines different roles users can have (e.g., Admin, User, Manager).
Permissions: Stores actions allowed for specific roles (e.g., read, write, delete).
User_Roles: Links users to their roles (many-to-many between users and roles).
Role_Permissions: Links roles to their permissions (many-to-many between roles and permissions).
System_Log: Logs user activities in the system.

Relationships:
One-to-Many between Roles and Users (A role can be assigned to multiple users, but each user has one primary role).
Many-to-Many between Users and Roles via User_Roles (A user can have multiple roles, and each role can belong to multiple users).
Many-to-Many between Roles and Permissions via Role_Permissions (A role can have multiple permissions, and each permission can belong to multiple roles).
One-to-Many between Users and System_Log (Each user can have multiple system activities logged).

SQL Command

SQL commands to handle various operations, including creating tables, inserting data, updating, deleting, performing joins, using DDL, DML, DCL, and TCL operations, and running basic queries.

3.  Create the Tables from the Diagram (DDL: Data Definition Language)

 CREATE TABLE Users (
    user_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(100) UNIQUE NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    password_hash VARCHAR2(255) NOT NULL,
    created_at DATE DEFAULT SYSDATE
);

CREATE TABLE Roles (
    role_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    role_name VARCHAR2(50) UNIQUE NOT NULL
);

CREATE TABLE Permissions (
    permission_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    permission_name VARCHAR2(50) UNIQUE NOT NULL,
    description VARCHAR2(255)
);

CREATE TABLE User_Roles (
    user_id NUMBER,
    role_id NUMBER,
    PRIMARY KEY (user_id, role_id),
    FOREIGN KEY (user_id) REFERENCES Users(user_id) ON DELETE CASCADE,
    FOREIGN KEY (role_id) REFERENCES Roles(role_id) ON DELETE CASCADE
);

CREATE TABLE Role_Permissions (
    role_id NUMBER,
    permission_id NUMBER,
    PRIMARY KEY (role_id, permission_id),
    FOREIGN KEY (role_id) REFERENCES Roles(role_id) ON DELETE CASCADE,
    FOREIGN KEY (permission_id) REFERENCES Permissions(permission_id) ON DELETE CASCADE
);

CREATE TABLE System_Log (
    log_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id NUMBER,
    activity VARCHAR2(255) NOT NULL,
    log_time TIMESTAMP DEFAULT SYSTIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES Users(user_id) ON DELETE CASCADE
);

4. Insert Data into Tables (DML: Data Manipulation Language)

-- Insert into Users
INSERT INTO Users (username, email, password_hash) VALUES ('john_doe', 'john@example.com', 'hashed_pw');
INSERT INTO Users (username, email, password_hash) VALUES ('jane_doe', 'jane@example.com', 'hashed_pw');

-- Insert into Roles
INSERT INTO Roles (role_name) VALUES ('Admin');
INSERT INTO Roles (role_name) VALUES ('User');

-- Insert into Permissions
INSERT INTO Permissions (permission_name, description) VALUES ('Read', 'Can read data');
INSERT INTO Permissions (permission_name, description) VALUES ('Write', 'Can write data');

-- Assign Roles to Users (inserting into User_Roles)
INSERT INTO User_Roles (user_id, role_id) VALUES (1, 1); -- John is Admin
INSERT INTO User_Roles (user_id, role_id) VALUES (2, 2); -- Jane is User

-- Assign Permissions to Roles (inserting into Role_Permissions)
INSERT INTO Role_Permissions (role_id, permission_id) VALUES (1, 1); -- Admin can read
INSERT INTO Role_Permissions (role_id, permission_id) VALUES (1, 2); -- Admin can write
INSERT INTO Role_Permissions (role_id, permission_id) VALUES (2, 1); -- User can read

-- Log User Activity
INSERT INTO System_Log (user_id, activity) VALUES (1, 'Logged in');
INSERT INTO System_Log (user_id, activity) VALUES (2, 'Viewed Dashboard');

5. Update Data (DML: Data Manipulation Language)

   UPDATE Users
SET email = 'john.doe@newmail.com'
WHERE user_id = 1;

6.  Delete Data (DML: Data Manipulation Language)
  
DELETE FROM System_Log
WHERE user_id = 2 AND activity = 'Viewed Dashboard';

7. Perform Joins to Retrieve Related Data

   SELECT u.username, r.role_name
FROM Users u
JOIN User_Roles ur ON u.user_id = ur.user_id
JOIN Roles r ON ur.role_id = r.role_id;

8.DDL (Data Definition Language)
DDL includes CREATE, ALTER, DROP, etc.

-- Example of adding a column to a table (ALTER TABLE)
ALTER TABLE Users ADD last_login DATE;

9.DML (Data Manipulation Language)
DML includes SELECT, INSERT, UPDATE, DELETE

-- Inserting a record
INSERT INTO Users (username, email, password_hash) VALUES ('alex_smith', 'alex@example.com', 'hashed_pw');

-- Updating a record
UPDATE Users SET password_hash = 'new_hashed_pw' WHERE username = 'john_doe';

-- Deleting a record
DELETE FROM Users WHERE user_id = 3;

DCL (Data Control Language)
DCL includes GRANT, REVOKE commands for managing permissions.

-- Grant a user SELECT permission on a table
GRANT SELECT ON Users TO some_user;

-- Revoke permission
REVOKE SELECT ON Users FROM some_user;

10.TCL (Transaction Control Language)
TCL includes COMMIT, ROLLBACK, SAVEPOINT.

-- Start a transaction, insert data, and then commit it
BEGIN
    INSERT INTO Users (username, email, password_hash) VALUES ('mark_twain', 'mark@example.com', 'hashed_pw');
    COMMIT;
END;

-- Insert data and rollback the transaction
BEGIN
    INSERT INTO Users (username, email, password_hash) VALUES ('samuel_clemens', 'sam@example.com', 'hashed_pw');
    ROLLBACK; -- This will undo the insertion
END;

11.Subqueries
SELECT username
FROM Users
WHERE user_id IN (
    SELECT user_id
    FROM User_Roles
    WHERE role_id = (SELECT role_id FROM Roles WHERE role_name = 'Admin')
);

System Management System - README

1. Problem Statement
The System Management System is designed to manage users, their roles, and permissions within a system. It provides a secure way to track the activities of users, assign roles, and set permissions. This system can be extended to manage a variety of applications, including enterprise resource management, user authentication, and access control.

2. SQL Commands Executed
2.1 DDL Commands (Data Definition Language)
Table Creation: The following SQL commands were used to create the tables in the database:
CREATE TABLE Users (
    user_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(100) UNIQUE NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    password_hash VARCHAR2(255) NOT NULL,
    created_at DATE DEFAULT SYSDATE
);

CREATE TABLE Roles (
    role_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    role_name VARCHAR2(50) UNIQUE NOT NULL
);

CREATE TABLE Permissions (
    permission_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    permission_name VARCHAR2(50) UNIQUE NOT NULL,
    description VARCHAR2(255)
);

CREATE TABLE User_Roles (
    user_id NUMBER,
    role_id NUMBER,
    PRIMARY KEY (user_id, role_id),
    FOREIGN KEY (user_id) REFERENCES Users(user_id) ON DELETE CASCADE,
    FOREIGN KEY (role_id) REFERENCES Roles(role_id) ON DELETE CASCADE
);

CREATE TABLE Role_Permissions (
    role_id NUMBER,
    permission_id NUMBER,
    PRIMARY KEY (role_id, permission_id),
    FOREIGN KEY (role_id) REFERENCES Roles(role_id) ON DELETE CASCADE,
    FOREIGN KEY (permission_id) REFERENCES Permissions(permission_id) ON DELETE CASCADE
);

CREATE TABLE System_Log (
    log_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id NUMBER,
    activity VARCHAR2(255) NOT NULL,
    log_time TIMESTAMP DEFAULT SYSTIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES Users(user_id) ON DELETE CASCADE
);
2.2 DML Commands (Data Manipulation Language)
Inserting Data:
-- Insert into Users
INSERT INTO Users (username, email, password_hash) VALUES ('john_doe', 'john@example.com', 'hashed_pw');
INSERT INTO Users (username, email, password_hash) VALUES ('jane_doe', 'jane@example.com', 'hashed_pw');

-- Insert into Roles
INSERT INTO Roles (role_name) VALUES ('Admin');
INSERT INTO Roles (role_name) VALUES ('User');

-- Insert into Permissions
INSERT INTO Permissions (permission_name, description) VALUES ('Read', 'Can read data');
INSERT INTO Permissions (permission_name, description) VALUES ('Write', 'Can write data');

-- Assign Roles to Users
INSERT INTO User_Roles (user_id, role_id) VALUES (1, 1); -- John is Admin
INSERT INTO User_Roles (user_id, role_id) VALUES (2, 2); -- Jane is User

-- Assign Permissions to Roles
INSERT INTO Role_Permissions (role_id, permission_id) VALUES (1, 1); -- Admin can read
INSERT INTO Role_Permissions (role_id, permission_id) VALUES (1, 2); -- Admin can write
INSERT INTO Role_Permissions (role_id, permission_id) VALUES (2, 1); -- User can read

-- Log User Activity
INSERT INTO System_Log (user_id, activity) VALUES (1, 'Logged in');
INSERT INTO System_Log (user_id, activity) VALUES (2, 'Viewed Dashboard');

.Updating Data:
-- Update user email
UPDATE Users
SET email = 'john.doe@newmail.com'
WHERE user_id = 1;

 .Deleting Data:
 -- Delete a specific log entry
DELETE FROM System_Log
WHERE user_id = 2 AND activity = 'Viewed Dashboard';

2.3 DCL Commands (Data Control Language)

Granting Permissions:
GRANT SELECT ON Users TO some_user;
Revoking Permissions:
REVOKE SELECT ON Users FROM some_user;

2.4 TCL Commands (Transaction Control Language)
Commit:
-- Start a transaction and commit it
BEGIN
    INSERT INTO Users (username, email, password_hash) VALUES ('alex_smith', 'alex@example.com', 'hashed_pw');
    COMMIT;
END;
.Rollback:
-- Insert data and rollback
BEGIN
    INSERT INTO Users (username, email, password_hash) VALUES ('mark_twain', 'mark@example.com', 'hashed_pw');
    ROLLBACK; -- This will undo the insertion
END;
conclusion:
This README file serves as an overview of the System Management System and outlines the key SQL commands used, the relationships between tables, and examples of query execution
